// generate-assets.js
import fs from "fs";
import path from "path";
import https from "https";

const baseDir = path.join(process.cwd(), "assets");
const placeholder = "https://via.placeholder.com/800x600/f5f5f5/000000?text=";

const structure = {
  ingredients: [
    "masa-tradicional", "masa-delgada", "masa-integral", "masa-gruesa",
    "mozzarella", "parmesano", "queso-azul", "cheddar",
    "salsa-tomate", "salsa-bbq", "salsa-blanca", "pesto",
    "pepperoni", "jamon", "salchicha", "carne-molida", "pollo", "tocino",
    "champinones", "pimientos", "cebolla", "tomate", "aceitunas",
    "jalapenos", "pina", "espinaca", "oregano", "ajo", "albahaca"
  ],
  pizzas: [
    "margarita", "pepperoni", "hawaiana", "cuatro-quesos",
    "carnivora", "vegetariana", "bbq-chicken", "mexicana"
  ],
  drinks: [
    "coca-cola", "coca-cola-1l", "sprite", "fanta",
    "agua", "jugo-naranja", "te-helado", "cerveza"
  ]
};

// FunciÃ³n para descargar imagen
function downloadImage(url, dest) {
  return new Promise((resolve, reject) => {
    const file = fs.createWriteStream(dest);
    https.get(url, response => {
      if (response.statusCode !== 200) {
        reject(new Error(`Error ${response.statusCode} al descargar ${url}`));
        return;
      }
      response.pipe(file);
      file.on("finish", () => file.close(resolve));
    }).on("error", err => {
      fs.unlink(dest, () => reject(err));
    });
  });
}

// Crear carpetas y descargar imÃ¡genes
async function generateAssets() {
  console.log("ğŸ“¦ Generando estructura de assets...");

  for (const [folder, files] of Object.entries(structure)) {
    const folderPath = path.join(baseDir, folder);
    fs.mkdirSync(folderPath, { recursive: true });

    for (const name of files) {
      const filePath = path.join(folderPath, `${name}.jpg`);
      const url = `${placeholder}${encodeURIComponent(name)}`;
      console.log(`ğŸ–¼ï¸ Descargando ${name}.jpg`);
      await downloadImage(url, filePath);
    }
  }

  console.log("\nâœ… Â¡Assets generados exitosamente!");
  console.log("Ruta de salida:", baseDir);
}

generateAssets().catch(err => console.error("âŒ Error:", err));
